#include "FEX/fex_test_loader.hpp"

#define VEX_TEST(opcode)                                                                                                                             \
    CATCH_TEST_CASE(#opcode, "[VEX]") {                                                                                                              \
        if (Extensions::VLEN >= 256) {                                                                                                               \
            FEXTestLoader::RunTest("ASM/VEX/" #opcode ".asm");                                                                                       \
        } else {                                                                                                                                     \
            SUCCESS("Skipping test " #opcode ", VLEN less than 256");                                                                                \
        }                                                                                                                                            \
    }

#define VEX_CRYPTO_TEST(opcode)                                                                                                                      \
    CATCH_TEST_CASE(#opcode, "[VEX]") {                                                                                                              \
        if (Extensions::Zvkned && Extensions::VLEN >= 256) {                                                                                         \
            FEXTestLoader::RunTest("ASM/VEX/" #opcode ".asm");                                                                                       \
        } else {                                                                                                                                     \
            SUCCESS("Skipping test " #opcode ", no Zvkned or VLEN less than 256");                                                                   \
        }                                                                                                                                            \
    }

#define VGATHER_TEST(opcode)                                                                                                                         \
    CATCH_TEST_CASE(#opcode, "[VEX]") {                                                                                                              \
        if (Extensions::Zicclsm && Extensions::VLEN >= 256) {                                                                                        \
            FEXTestLoader::RunTest("ASM/VEX/" #opcode ".asm");                                                                                       \
        } else {                                                                                                                                     \
            SUCCESS("Skipping test " #opcode ", no Zicclsm or VLEN less than 256");                                                                  \
        }                                                                                                                                            \
    }

VEX_TEST(andn);
VEX_TEST(bextr);
VEX_TEST(blsi);
VEX_TEST(blsmsk);
VEX_TEST(blsr);

// VEX_TEST(bzhi);
// VEX_TEST(mulx);
// VEX_TEST(pdep);
// VEX_TEST(pext);
// VEX_TEST(rorx);
// VEX_TEST(sarx);
// VEX_TEST(shlx);
// VEX_TEST(shrx);

VEX_TEST(vaddpd);
VEX_TEST(vaddps);
VEX_TEST(vaddsd);
VEX_TEST(vaddss);
VEX_TEST(vaddsubpd);
VEX_TEST(vaddsubps);
VEX_CRYPTO_TEST(vaesdec);
VEX_CRYPTO_TEST(vaesdec256);
VEX_CRYPTO_TEST(vaesdeclast);
VEX_CRYPTO_TEST(vaesdeclast256);
VEX_CRYPTO_TEST(vaesenc);
VEX_CRYPTO_TEST(vaesenc256);
VEX_CRYPTO_TEST(vaesenclast);
VEX_CRYPTO_TEST(vaesenclast256);
VEX_CRYPTO_TEST(vaesimc);
VEX_CRYPTO_TEST(vaeskeygenassist);
VEX_TEST(vandnpd);
VEX_TEST(vandnps);
VEX_TEST(vandpd);
VEX_TEST(vandps);
VEX_TEST(vblendpd);
VEX_TEST(vblendps);
VEX_TEST(vblendvpd);
VEX_TEST(vblendvps);
VEX_TEST(vbroadcastf128);
VEX_TEST(vbroadcasti128);
VEX_TEST(vbroadcastsd);
VEX_TEST(vbroadcastss);
VEX_TEST(vcmppd);
VEX_TEST(vcmppd_256);
VEX_TEST(vcmpps);
VEX_TEST(vcmpps_256);
VEX_TEST(vcmpsd);
VEX_TEST(vcmpss);
VEX_TEST(vcomisd);
VEX_TEST(vcomiss);
VEX_TEST(vcvtdq2pd);
VEX_TEST(vcvtdq2ps);
VEX_TEST(vcvtpd2dq);
VEX_TEST(vcvtpd2dq_inexact);
VEX_TEST(vcvtpd2ps);
VEX_TEST(vcvtph2ps);
VEX_TEST(vcvtps2dq);
VEX_TEST(vcvtps2dq_inexact);
VEX_TEST(vcvtps2pd);
VEX_TEST(vcvtps2ph_rd);
VEX_TEST(vcvtps2ph_rd_mxcsr);
VEX_TEST(vcvtps2ph_rtne);
VEX_TEST(vcvtps2ph_rtne_mxcsr);
VEX_TEST(vcvtps2ph_ru);
VEX_TEST(vcvtps2ph_ru_mxcsr);
VEX_TEST(vcvtps2ph_trunc);
VEX_TEST(vcvtps2ph_trunc_mxcsr);
VEX_TEST(vcvtsd2si);
VEX_TEST(vcvtsd2ss);
VEX_TEST(vcvtsi2sd);
VEX_TEST(vcvtsi2ss);
VEX_TEST(vcvtss2sd);
VEX_TEST(vcvtss2si);
VEX_TEST(vcvttpd2dq);
VEX_TEST(vcvttps2dq);
VEX_TEST(vcvttsd2si);
VEX_TEST(vcvttss2si);
VEX_TEST(vdivpd);
VEX_TEST(vdivps);
VEX_TEST(vdivsd);
VEX_TEST(vdivss);
VEX_TEST(vdppd);
VEX_TEST(vdpps_128);
VEX_TEST(vdpps_256);
VEX_TEST(vextractf128);
VEX_TEST(vextracti128);
VEX_TEST(vextractps);
VGATHER_TEST(vgather_dpd_128bit_1xdisp);
VGATHER_TEST(vgather_dpd_128bit_2xdisp);
VGATHER_TEST(vgather_dpd_128bit_4xdisp);
VGATHER_TEST(vgather_dpd_128bit_8xdisp);
VGATHER_TEST(vgather_dpd_256bit_1xdisp);
VGATHER_TEST(vgather_dpd_256bit_2xdisp);
VGATHER_TEST(vgather_dpd_256bit_4xdisp);
VGATHER_TEST(vgather_dpd_256bit_8xdisp);
VGATHER_TEST(vgather_dps_128bit_1xdisp);
VGATHER_TEST(vgather_dps_128bit_2xdisp);
VGATHER_TEST(vgather_dps_128bit_4xdisp);
VGATHER_TEST(vgather_dps_128bit_8xdisp);
VGATHER_TEST(vgather_dps_256bit_1xdisp);
VGATHER_TEST(vgather_dps_256bit_2xdisp);
VGATHER_TEST(vgather_dps_256bit_4xdisp);
VGATHER_TEST(vgather_dps_256bit_8xdisp);
VGATHER_TEST(vgather_qpd_128bit_1xdisp);
VGATHER_TEST(vgather_qpd_128bit_1xdisp_overflow);
VGATHER_TEST(vgather_qpd_128bit_2xdisp);
VGATHER_TEST(vgather_qpd_128bit_2xdisp_overflow);
VGATHER_TEST(vgather_qpd_128bit_4xdisp);
VGATHER_TEST(vgather_qpd_128bit_4xdisp_overflow);
VGATHER_TEST(vgather_qpd_128bit_8xdisp);
VGATHER_TEST(vgather_qpd_128bit_8xdisp_overflow);
VGATHER_TEST(vgather_qpd_256bit_1xdisp);
VGATHER_TEST(vgather_qpd_256bit_1xdisp_overflow);
VGATHER_TEST(vgather_qpd_256bit_2xdisp);
VGATHER_TEST(vgather_qpd_256bit_2xdisp_overflow);
VGATHER_TEST(vgather_qpd_256bit_4xdisp);
VGATHER_TEST(vgather_qpd_256bit_4xdisp_overflow);
VGATHER_TEST(vgather_qpd_256bit_8xdisp);
VGATHER_TEST(vgather_qpd_256bit_8xdisp_overflow);
VGATHER_TEST(vgather_qps_128bit_1xdisp);
VGATHER_TEST(vgather_qps_128bit_1xdisp_overflow);
VGATHER_TEST(vgather_qps_128bit_2xdisp);
VGATHER_TEST(vgather_qps_128bit_2xdisp_overflow);
VGATHER_TEST(vgather_qps_128bit_4xdisp);
VGATHER_TEST(vgather_qps_128bit_4xdisp_overflow);
VGATHER_TEST(vgather_qps_128bit_8xdisp);
VGATHER_TEST(vgather_qps_128bit_8xdisp_overflow);
VGATHER_TEST(vgather_qps_256bit_1xdisp);
VGATHER_TEST(vgather_qps_256bit_1xdisp_overflow);
VGATHER_TEST(vgather_qps_256bit_2xdisp);
VGATHER_TEST(vgather_qps_256bit_2xdisp_overflow);
VGATHER_TEST(vgather_qps_256bit_4xdisp);
VGATHER_TEST(vgather_qps_256bit_4xdisp_overflow);
VGATHER_TEST(vgather_qps_256bit_8xdisp);
VGATHER_TEST(vgather_qps_256bit_8xdisp_overflow);
VEX_TEST(vhaddpd);
VEX_TEST(vhaddps);
VEX_TEST(vhsubpd);
VEX_TEST(vhsubps);
VEX_TEST(vinsertf128);
VEX_TEST(vinserti128);
VEX_TEST(vinsertps);
VEX_TEST(vlddqu);
VEX_TEST(vldmxcsr);
VEX_TEST(vmaskmovdqu);
VEX_TEST(vmaskmovpd_load);
VEX_TEST(vmaskmovpd_store);
VEX_TEST(vmaskmovps_load);
VEX_TEST(vmaskmovps_store);
VEX_TEST(vmaxpd);
VEX_TEST(vmaxps);
VEX_TEST(vmaxsd);
VEX_TEST(vmaxss);
VEX_TEST(vminpd);
VEX_TEST(vminps);
VEX_TEST(vminsd);
VEX_TEST(vminss);
VEX_TEST(vmovapd);
VEX_TEST(vmovapd_mem);
VEX_TEST(vmovaps);
VEX_TEST(vmovaps_mem);
VEX_TEST(vmovddup);
VEX_TEST(vmovdqa);
VEX_TEST(vmovdqu);
VEX_TEST(vmovhlps);
VEX_TEST(vmovhpd);
VEX_TEST(vmovhps);
VEX_TEST(vmovlhps);
VEX_TEST(vmovlpd);
VEX_TEST(vmovlps);
VEX_TEST(vmovmskpd);
VEX_TEST(vmovmskps);
VEX_TEST(vmovntdq);
VEX_TEST(vmovntdqa);
VEX_TEST(vmovntpd);
VEX_TEST(vmovntps);
VEX_TEST(vmovq);
VEX_TEST(vmovq_vmovd_reg);
VEX_TEST(vmovsd_from_mem);
VEX_TEST(vmovsd_to_mem);
VEX_TEST(vmovsd_vectors);
VEX_TEST(vmovshdup);
VEX_TEST(vmovsldup);
VEX_TEST(vmovss_from_mem);
VEX_TEST(vmovss_to_mem);
VEX_TEST(vmovss_vectors);
VEX_TEST(vmovupd);
VEX_TEST(vmovupd_mem);
VEX_TEST(vmovups);
VEX_TEST(vmovups_mem);
VEX_TEST(vmpsadbw_128);
VEX_TEST(vmpsadbw_256);
VEX_TEST(vmulpd);
VEX_TEST(vmulps);
VEX_TEST(vmulsd);
VEX_TEST(vmulss);
VEX_TEST(vorpd);
VEX_TEST(vorps);
VEX_TEST(vpabsb);
VEX_TEST(vpabsd);
VEX_TEST(vpabsw);
VEX_TEST(vpackssdw);
VEX_TEST(vpacksswb);
VEX_TEST(vpackusdw);
VEX_TEST(vpackuswb);
VEX_TEST(vpaddb);
VEX_TEST(vpaddd);
VEX_TEST(vpaddq);
VEX_TEST(vpaddsb);
VEX_TEST(vpaddsw);
VEX_TEST(vpaddusb);
VEX_TEST(vpaddusw);
VEX_TEST(vpaddw);
VEX_TEST(vpalignr);
VEX_TEST(vpand);
VEX_TEST(vpandn);
VEX_TEST(vpavgb);
VEX_TEST(vpavgb_aliasing);
VEX_TEST(vpavgw);
VEX_TEST(vpavgw_aliasing);
VEX_TEST(vpblendd);
VEX_TEST(vpblendvb);
VEX_TEST(vpblendw);
VEX_TEST(vpbroadcastb);
VEX_TEST(vpbroadcastd);
VEX_TEST(vpbroadcastq);
VEX_TEST(vpbroadcastw);
// VEX_TEST(vpclmulqdq); TODO: VPCLMULQDQ
// VEX_TEST(vpclmulqdq_256);
VEX_TEST(vpcmpeqb);
VEX_TEST(vpcmpeqd);
VEX_TEST(vpcmpeqq);
VEX_TEST(vpcmpeqw);
VEX_TEST(vpcmpestri_equal_any);
VEX_TEST(vpcmpestri_equal_each);
VEX_TEST(vpcmpestri_equal_ordered);
VEX_TEST(vpcmpestri_ranges);
VEX_TEST(vpcmpestrm_equal_any);
VEX_TEST(vpcmpestrm_equal_each);
VEX_TEST(vpcmpestrm_equal_ordered);
VEX_TEST(vpcmpestrm_ranges);
VEX_TEST(vpcmpgtb);
VEX_TEST(vpcmpgtd);
VEX_TEST(vpcmpgtq);
VEX_TEST(vpcmpgtw);
VEX_TEST(vpcmpistri_equal_any);
VEX_TEST(vpcmpistri_equal_each);
VEX_TEST(vpcmpistri_equal_ordered);
VEX_TEST(vpcmpistri_ranges);
VEX_TEST(vpcmpistrm_equal_any);
VEX_TEST(vpcmpistrm_equal_each);
VEX_TEST(vpcmpistrm_equal_ordered);
VEX_TEST(vpcmpistrm_ranges);
VEX_TEST(vperm2f128);
VEX_TEST(vperm2i128);
VEX_TEST(vpermd);
VEX_TEST(vpermilpd_imm);
VEX_TEST(vpermilpd_reg);
VEX_TEST(vpermilps_imm);
VEX_TEST(vpermilps_reg);
VEX_TEST(vpermpd);
VEX_TEST(vpermps);
VEX_TEST(vpermq);
VEX_TEST(vpextrb);
VEX_TEST(vpextrd);
VEX_TEST(vpextrq);
VEX_TEST(vpextrw);
VGATHER_TEST(vpgather_dd_128bit_1xdisp);
VGATHER_TEST(vpgather_dd_128bit_2xdisp);
VGATHER_TEST(vpgather_dd_128bit_4xdisp);
VGATHER_TEST(vpgather_dd_128bit_8xdisp);
VGATHER_TEST(vpgather_dd_256bit_1xdisp);
VGATHER_TEST(vpgather_dd_256bit_2xdisp);
VGATHER_TEST(vpgather_dd_256bit_4xdisp);
VGATHER_TEST(vpgather_dd_256bit_8xdisp);
VGATHER_TEST(vpgather_dq_128bit_1xdisp);
VGATHER_TEST(vpgather_dq_128bit_2xdisp);
VGATHER_TEST(vpgather_dq_128bit_4xdisp);
VGATHER_TEST(vpgather_dq_128bit_8xdisp);
VGATHER_TEST(vpgather_dq_256bit_1xdisp);
VGATHER_TEST(vpgather_dq_256bit_2xdisp);
VGATHER_TEST(vpgather_dq_256bit_4xdisp);
VGATHER_TEST(vpgather_dq_256bit_8xdisp);
VGATHER_TEST(vpgather_qd_128bit_1xdisp);
VGATHER_TEST(vpgather_qd_128bit_1xdisp_overflow);
VGATHER_TEST(vpgather_qd_128bit_2xdisp);
VGATHER_TEST(vpgather_qd_128bit_2xdisp_overflow);
VGATHER_TEST(vpgather_qd_128bit_4xdisp);
VGATHER_TEST(vpgather_qd_128bit_4xdisp_overflow);
VGATHER_TEST(vpgather_qd_128bit_8xdisp);
VGATHER_TEST(vpgather_qd_128bit_8xdisp_overflow);
VGATHER_TEST(vpgather_qd_256bit_1xdisp);
VGATHER_TEST(vpgather_qd_256bit_1xdisp_overflow);
VGATHER_TEST(vpgather_qd_256bit_2xdisp);
VGATHER_TEST(vpgather_qd_256bit_2xdisp_overflow);
VGATHER_TEST(vpgather_qd_256bit_4xdisp);
VGATHER_TEST(vpgather_qd_256bit_4xdisp_overflow);
VGATHER_TEST(vpgather_qd_256bit_8xdisp);
VGATHER_TEST(vpgather_qd_256bit_8xdisp_overflow);
VGATHER_TEST(vpgather_qq_128bit_1xdisp);
VGATHER_TEST(vpgather_qq_128bit_1xdisp_overflow);
VGATHER_TEST(vpgather_qq_128bit_2xdisp);
VGATHER_TEST(vpgather_qq_128bit_2xdisp_overflow);
VGATHER_TEST(vpgather_qq_128bit_4xdisp);
VGATHER_TEST(vpgather_qq_128bit_4xdisp_overflow);
VGATHER_TEST(vpgather_qq_128bit_8xdisp);
VGATHER_TEST(vpgather_qq_128bit_8xdisp_overflow);
VGATHER_TEST(vpgather_qq_256bit_1xdisp);
VGATHER_TEST(vpgather_qq_256bit_1xdisp_overflow);
VGATHER_TEST(vpgather_qq_256bit_2xdisp);
VGATHER_TEST(vpgather_qq_256bit_2xdisp_overflow);
VGATHER_TEST(vpgather_qq_256bit_4xdisp);
VGATHER_TEST(vpgather_qq_256bit_4xdisp_overflow);
VGATHER_TEST(vpgather_qq_256bit_8xdisp);
VGATHER_TEST(vpgather_qq_256bit_8xdisp_overflow);
VEX_TEST(vphaddd);
VEX_TEST(vphaddsw);
VEX_TEST(vphaddsw_256);
VEX_TEST(vphaddw);
VEX_TEST(vphminposuw);
VEX_TEST(vphsubd);
VEX_TEST(vphsubsw);
VEX_TEST(vphsubsw_256);
VEX_TEST(vphsubw);
VEX_TEST(vpinsrb);
VEX_TEST(vpinsrd);
VEX_TEST(vpinsrq);
VEX_TEST(vpinsrw);
VEX_TEST(vpmaddubsw);
VEX_TEST(vpmaddubsw_256);
VEX_TEST(vpmaddwd);
VEX_TEST(vpmaskmovd_load);
VEX_TEST(vpmaskmovd_store);
VEX_TEST(vpmaskmovq_load);
VEX_TEST(vpmaskmovq_store);
VEX_TEST(vpmaxsb);
VEX_TEST(vpmaxsd);
VEX_TEST(vpmaxsw);
VEX_TEST(vpmaxub);
VEX_TEST(vpmaxud);
VEX_TEST(vpmaxuw);
VEX_TEST(vpminsb);
VEX_TEST(vpminsd);
VEX_TEST(vpminsw);
VEX_TEST(vpminub);
VEX_TEST(vpminud);
VEX_TEST(vpminuw);
VEX_TEST(vpmovmskb);
VEX_TEST(vpmovsxbd);
VEX_TEST(vpmovsxbq);
VEX_TEST(vpmovsxbw);
VEX_TEST(vpmovsxdq);
VEX_TEST(vpmovsxwd);
VEX_TEST(vpmovsxwq);
VEX_TEST(vpmovzxbd);
VEX_TEST(vpmovzxbq);
VEX_TEST(vpmovzxbw);
VEX_TEST(vpmovzxdq);
VEX_TEST(vpmovzxwd);
VEX_TEST(vpmovzxwq);
VEX_TEST(vpmuldq);
VEX_TEST(vpmuldq_256);
VEX_TEST(vpmulhrsw);
VEX_TEST(vpmulhuw);
VEX_TEST(vpmulhw);
VEX_TEST(vpmulld);
VEX_TEST(vpmullw);
VEX_TEST(vpmuludq);
VEX_TEST(vpor);
VEX_TEST(vpsadbw);
VEX_TEST(vpsadbw_256);
VEX_TEST(vpshufb);
VEX_TEST(vpshufd);
VEX_TEST(vpshufhw);
VEX_TEST(vpshuflw);
VEX_TEST(vpsignb);
VEX_TEST(vpsignd);
VEX_TEST(vpsignw);
VEX_TEST(vpslld);
VEX_TEST(vpslld_imm);
VEX_TEST(vpslldq);
VEX_TEST(vpsllq);
VEX_TEST(vpsllq_imm);
VEX_TEST(vpsllvd);
VEX_TEST(vpsllvq);
VEX_TEST(vpsllw);
VEX_TEST(vpsllw_imm);
VEX_TEST(vpsrad);
VEX_TEST(vpsrad_imm);
VEX_TEST(vpsravd);
VEX_TEST(vpsraw);
VEX_TEST(vpsraw_imm);
VEX_TEST(vpsrld);
VEX_TEST(vpsrld_imm);
VEX_TEST(vpsrldq);
VEX_TEST(vpsrlq);
VEX_TEST(vpsrlq_imm);
VEX_TEST(vpsrlvd);
VEX_TEST(vpsrlvq);
VEX_TEST(vpsrlw);
VEX_TEST(vpsrlw_imm);
VEX_TEST(vpsubb);
VEX_TEST(vpsubd);
VEX_TEST(vpsubq);
VEX_TEST(vpsubsb);
VEX_TEST(vpsubsw);
VEX_TEST(vpsubusb);
VEX_TEST(vpsubusw);
VEX_TEST(vpsubw);
VEX_TEST(vptest);
VEX_TEST(vpunpckhbw);
VEX_TEST(vpunpckhdq);
VEX_TEST(vpunpckhqdq);
VEX_TEST(vpunpckhwd);
VEX_TEST(vpunpcklbw);
VEX_TEST(vpunpckldq);
VEX_TEST(vpunpcklqdq);
VEX_TEST(vpunpcklwd);
VEX_TEST(vpxor);
VEX_TEST(vrcpps);
VEX_TEST(vrcpss);
VEX_TEST(vroundpd);
VEX_TEST(vroundps);
VEX_TEST(vroundsd);
VEX_TEST(vroundss);
VEX_TEST(vrsqrtps);
VEX_TEST(vrsqrtss);
VEX_TEST(vshufpd);
VEX_TEST(vshufps);
VEX_TEST(vsqrtpd);
VEX_TEST(vsqrtps);
VEX_TEST(vsqrtsd);
VEX_TEST(vsqrtss);
VEX_TEST(vsubpd);
VEX_TEST(vsubps);
VEX_TEST(vsubsd);
VEX_TEST(vsubss);
VEX_TEST(vtestpd);
VEX_TEST(vtestps);
VEX_TEST(vucomisd);
VEX_TEST(vucomiss);
VEX_TEST(vunpckhpd);
VEX_TEST(vunpckhps);
VEX_TEST(vunpcklpd);
VEX_TEST(vunpcklps);
VEX_TEST(vxorpd);
VEX_TEST(vxorps);
VEX_TEST(vzeroall);
VEX_TEST(vzeroupper);
